{
    "name": "App DevContainer",
    "dockerComposeFile": [
        // base compose file
        "../../compose.yaml",
        // devcontainer specific overrides
        "../compose-devcontainer.yaml"
    ],
    "service": "app",
    "workspaceFolder": "/workspace/app",
    "remoteUser": "vscode", // use non-root user
    "updateRemoteUserUID": true,
    // @see https://containers.dev/features
    "features": {
        "ghcr.io/devcontainers/features/common-utils:2": {
            "installZsh": "true",
            "username": "vscode",
            "userUid": "10001",
            "userGid": "10001",
            "upgradePackages": "true"
        },
        "ghcr.io/devcontainers/features/git:1": {
            "version": "latest",
            "ppa": "true"
        }
    },
    "customizations": {
        "vscode": {
            "extensions": [
                // linter/formatter
                "editorconfig.editorconfig",
                "biomejs.biome"
            ]
        }
    },
    // [DevContainer Lifecycle]
    // [host] Start process
    // - initializeCommand:
    //   - This runs on the host machine before the container is created.
    //   - [NOTICE] This runs before not only creating, but restarting, or connecting to the container.
    //   - @see https://github.com/microsoft/vscode-remote-release/issues/9278
    //   - [NOTE] If you want to use the terminal after reopening, you need to close the current terminal and open a new one.
    "initializeCommand": "echo '[host] initializeCommand...'",
    // - after initializeCommand:
    //   1. getting & building images
    //   2. starting containers
    // [host] End process on host machine
    // [container] Start process
    "onCreateCommand": "echo '[container] onCreateCommand...'",
    "updateContentCommand": "echo '[container] updateContentCommand...'",
    "postCreateCommand": "echo '[container] postCreateCommand...'",
    // - after postCreateCommand:
    //   1. install dotfiles, etc.
    //   2. start the VS Code server
    // - after starting the VS Code server:
    //   - parallel execution of:
    //     - postStartCommand > postAttachCommand
    //     - installing VS Code extensions
    "postStartCommand": "echo '[container] postStartCommand...'",
    // - postAttachCommand:
    //   - This runs every time you attach to the container (including after postStartCommand
    "postAttachCommand": "echo '[container] postAttachCommand...' && ${containerWorkspaceFolder}/../.devcontainer/postAttachCommand.sh"
    // [container] End process
}